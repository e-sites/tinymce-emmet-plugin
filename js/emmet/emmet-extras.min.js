emmet.define("cm-editor-proxy",function(e,t){function r(){var t=u.getSyntax();return e("resources").hasSyntax(t)}function n(){if(CodeMirror.version>="3.1")return CodeMirror.Pass;throw CodeMirror.Pass}function i(t,i){if(u.setupContext(i),"expand_abbreviation_with_tab"==t&&(u.getSelection()||!r()))return n();var o=!0;try{var l=e("actions").run(t,u);("next_edit_point"==t||"prev_edit_point"==t)&&i.replaceSelection(""),l||"insert_formatted_line_break_only"!=t||(o=!1)}catch(a){}return o?void 0:n()}var o=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),l=o||/Mac/.test(navigator.platform),a={"Cmd-E":"expand_abbreviation",Tab:"expand_abbreviation_with_tab","Cmd-D":"match_pair_outward","Shift-Cmd-D":"match_pair_inward","Cmd-T":"matching_pair","Shift-Cmd-A":"wrap_with_abbreviation","Ctrl-Alt-Right":"next_edit_point","Ctrl-Alt-Left":"prev_edit_point","Cmd-L":"select_line","Cmd-Shift-M":"merge_lines","Cmd-/":"toggle_comment","Cmd-J":"split_join_tag","Cmd-K":"remove_tag","Shift-Cmd-Y":"evaluate_math_expression","Ctrl-Up":"increment_number_by_1","Ctrl-Down":"decrement_number_by_1","Alt-Up":"increment_number_by_01","Alt-Down":"decrement_number_by_01","Ctrl-Alt-Up":"increment_number_by_10","Ctrl-Alt-Down":"decrement_number_by_10","Shift-Cmd-.":"select_next_item","Shift-Cmd-,":"select_previous_item","Cmd-B":"reflect_css_value",Enter:"insert_formatted_line_break_only"},s={"text/html":"html","application/xml":"xml","text/xsl":"xsl","text/css":"css","text/x-less":"less"};CodeMirror.defineOption?CodeMirror.defineOption("profile","html"):CodeMirror.defaults.profile="html";var u={context:null,getSelectionRange:function(){var e=this.getCaretPos();return{start:e,end:e+this.getSelection().length}},createSelection:function(e,t){e==t?this.context.setCursor(this.context.posFromIndex(e)):this.context.setSelection(this.context.posFromIndex(e),this.context.posFromIndex(t))},getCurrentLineRange:function(){var e=this.context.getCursor(!0);return{start:this.context.indexFromPos({line:e.line,ch:0}),end:this.context.indexFromPos({line:e.line,ch:this.context.getLine(e.line).length})}},getCaretPos:function(){return this.context.indexFromPos(this.context.getCursor(!0))},setCaretPos:function(e){this.createSelection(e,e)},getCurrentLine:function(){return this.context.getLine(this.context.getCursor(!0).line)||""},replaceContent:function(r,n,i,o){t.isUndefined(i)&&(i=t.isUndefined(n)?content.length:n),t.isUndefined(n)&&(n=0);var l=e("utils");o||(r=l.padString(r,l.getLinePaddingFromPosition(this.getContent(),n)));var a=e("tabStops").extract(r,{escape:function(e){return e}});r=a.text;var s=a.tabstops[0];s?(s.start+=n,s.end+=n):s={start:r.length+n,end:r.length+n};var u=this,c=this.context.operation||this.context.compoundChange;c.call(this.context,function(){u.context.replaceRange(r,u.context.posFromIndex(n),u.context.posFromIndex(i)),u.createSelection(s.start,s.end)})},getContent:function(){return this.context.getValue()},getSyntax:function(){var t=this.context.getOption("mode");return t in s&&(t=s[t]),e("actionUtils").detectSyntax(this,t)},getProfileName:function(){return this.context.getOption("profile")?this.context.getOption("profile"):e("actionUtils").detectProfile(this)},prompt:function(e){return prompt(e)},getSelection:function(){return this.context.getSelection()||""},getFilePath:function(){return location.href},setupContext:function(t){this.context=t;var r="	";t.getOption("indentWithTabs")||(r=e("utils").repeatString(" ",t.getOption("indentUnit"))),e("resources").setVariable("indentation",r)},addAction:function(e,t,r){var n="emmet."+e;CodeMirror.commands[n]||(CodeMirror.commands[n]=function(t){return i(e,t)}),t&&(r||(CodeMirror.keyMap&&CodeMirror.keyMap["default"]?r=CodeMirror.keyMap["default"]:(CodeMirror.defaults.extraKeys||(CodeMirror.defaults.extraKeys={}),r=CodeMirror.defaults.extraKeys)),l||(t=t.replace("Cmd","Ctrl")),r&&(r[t]=n))}};return"undefined"!=typeof emmetKeymap&&(a=emmetKeymap),t.each(a,function(e,t){u.addAction(e,t)}),u}),function(){CodeMirror.extendMode("css",{commentStart:"/*",commentEnd:"*/",newlineAfterToken:function(e,t){return/^[;{}]$/.test(t)}}),CodeMirror.extendMode("javascript",{commentStart:"/*",commentEnd:"*/",newlineAfterToken:function(e,t,r,n){return this.jsonMode?/^[\[,{]$/.test(t)||/^}/.test(r):";"==t&&n.lexical&&")"==n.lexical.type?!1:/^[;{}]$/.test(t)&&!/^;/.test(r)}}),CodeMirror.extendMode("xml",{commentStart:"<!--",commentEnd:"-->",newlineAfterToken:function(e,t,r){return"tag"==e&&/>$/.test(t)||/^</.test(r)}}),CodeMirror.defineExtension("commentRange",function(e,t,r){var n=this,i=CodeMirror.innerMode(n.getMode(),n.getTokenAt(t).state).mode;n.operation(function(){if(e)n.replaceRange(i.commentEnd,r),n.replaceRange(i.commentStart,t),t.line==r.line&&t.ch==r.ch&&n.setCursor(t.line,t.ch+i.commentStart.length);else{var o=n.getRange(t,r),l=o.indexOf(i.commentStart),a=o.lastIndexOf(i.commentEnd);l>-1&&a>-1&&a>l&&(o=o.substr(0,l)+o.substring(l+i.commentStart.length,a)+o.substr(a+i.commentEnd.length)),n.replaceRange(o,t,r)}})}),CodeMirror.defineExtension("autoIndentRange",function(e,t){var r=this;this.operation(function(){for(var n=e.line;t.line>=n;n++)r.indentLine(n,"smart")})}),CodeMirror.defineExtension("autoFormatRange",function(e,t){function r(){s+="\n",c=!0,++u}for(var n=this,i=n.getMode(),o=n.getRange(e,t).split("\n"),l=CodeMirror.copyState(i,n.getTokenAt(e).state),a=n.getOption("tabSize"),s="",u=0,c=0==e.ch,d=0;o.length>d;++d){for(var f=new CodeMirror.StringStream(o[d],a);!f.eol();){var h=CodeMirror.innerMode(i,l),p=i.token(f,l),m=f.current();f.start=f.pos,(!c||/\S/.test(m))&&(s+=m,c=!1),!c&&h.mode.newlineAfterToken&&h.mode.newlineAfterToken(p,m,f.string.slice(f.pos)||o[d+1]||"",h.state)&&r()}!f.pos&&i.blankLine&&i.blankLine(l),c||r()}n.operation(function(){n.replaceRange(s,e,t);for(var r=e.line+1,i=e.line+u;i>=r;++r)n.indentLine(r,"smart");n.setSelection(e,n.getCursor(!1))})})}(),function(e,t){"use strict";function r(){return{from:i.getCursor(!0),to:i.getCursor(!1)}}function n(){var e=r();i.autoFormatRange(e.from,e.to)}var i,o=e.parent.tinymce,l=o.activeEditor,o=(l.settings,e.parent.tinymce),l=o.activeEditor,a=t.getElementById("code");a.value=l.getContent({format:"raw"}),i=CodeMirror.fromTextArea(a,{mode:"text/html",lineNumbers:!0,indentWithTabs:!0,autofocus:!0}),CodeMirror.commands.selectAll(i),n(),i.on("change",function(e){l.setContent(e.getTextArea().value),l.nodeChanged(),e.save()}),i.on("blur",function(e){l.setContent(e.getTextArea().value),l.nodeChanged(),e.save()})}(window,document);